import{r as m,a as y,w as a,i as T,o as d,b as r,f as n,e as i,h as k,u as t,t as C,g as F,F as B,j as E}from"./index-BDwCyq8B.js";import{V as x,e as V,d as b,a as D,b as L,c as _}from"./VContainer-CJF3WIPt.js";import{V as j,a as w}from"./VRow-1GIz1IU7.js";function A(){const v=m("NDEFReader"in window),l=m(!1),o=m(null),u=m(null);return{isSupported:v,isReading:l,error:o,data:u,startScan:async()=>{if(!v.value){o.value="NFC no soportado en este dispositivo";return}try{const s=new NDEFReader;await s.scan(),l.value=!0,s.addEventListener("reading",({message:c,serialNumber:g})=>{u.value={serialNumber:g,records:c.records.map(f=>({recordType:f.recordType,mediaType:f.mediaType,id:f.id}))}}),s.addEventListener("readingerror",()=>{o.value="Error al leer NFC"})}catch(s){o.value=s.message||String(s),l.value=!1}},stopScan:()=>{l.value=!1}}}const q={__name:"NFC",setup(v){const{isSupported:l,isReading:o,error:u,data:p,startScan:N,stopScan:s}=A(),c=T(),g=()=>{window.history.length>1?c.back():c.push("/")};return(f,e)=>(d(),y(x,{class:"py-6"},{default:a(()=>[r(V,{text:"",onClick:g,class:"mr-2"},{default:a(()=>[...e[0]||(e[0]=[n("Back",-1)])]),_:1}),r(j,null,{default:a(()=>[r(w,{cols:"12"},{default:a(()=>[e[4]||(e[4]=i("h2",null,"Lectura NFC",-1)),t(l)?k("",!0):(d(),y(b,{key:0,type:"info",class:"mb-4"},{default:a(()=>[...e[1]||(e[1]=[n(" Este dispositivo/navegador no soporta NFC. Use QR como alternativa. ",-1)])]),_:1})),r(V,{disabled:!t(l)||t(o),color:"primary",onClick:t(N)},{default:a(()=>[...e[2]||(e[2]=[n("Iniciar lectura",-1)])]),_:1},8,["disabled","onClick"]),r(V,{class:"ml-2",disabled:!t(o),onClick:t(s)},{default:a(()=>[...e[3]||(e[3]=[n("Detener",-1)])]),_:1},8,["disabled","onClick"])]),_:1}),r(w,{cols:"12"},{default:a(()=>[t(p)?(d(),y(D,{key:0},{default:a(()=>[r(L,null,{default:a(()=>[...e[5]||(e[5]=[n("Resultado",-1)])]),_:1}),r(_,null,{default:a(()=>[i("div",null,[e[6]||(e[6]=i("strong",null,"Serial:",-1)),n(" "+C(t(p).serialNumber),1)]),e[7]||(e[7]=i("div",{class:"mt-2"},[i("strong",null,"Registros:")],-1)),i("ul",null,[(d(!0),F(B,null,E(t(p).records,(S,R)=>(d(),F("li",{key:R},C(S.recordType)+" ("+C(S.mediaType||"n/a")+")",1))),128))])]),_:1})]),_:1})):k("",!0),t(u)?(d(),y(b,{key:1,type:"error",class:"mt-4"},{default:a(()=>[n(C(t(u)),1)]),_:1})):k("",!0)]),_:1})]),_:1})]),_:1}))}};export{q as default};
